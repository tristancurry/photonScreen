<!DOCTYPE html>
<html>
  
<head>
<meta charset="utf-8">
<title>Photons on a Screen</title>
<style>
canvas {
    border: 3px #CCC solid;
}
</style>
</head>
<body>

<h1 id="theTitle">Photon detection</h1>



<div id="graphics">
    <canvas id="screen" height="600" width="600"></canvas>
</div>

<div id = "ui">
	<label for="brightnessS" >Brightness</label>
	<input type="range" id="brightnessS"  min="0" max ="10000" step="1" value="100" onInput="inputUpdate(value, min, max, id, 'brightnessT')" >
	<input type="text" id="brightnessT" min="0" max="10000"  value="100" onInput="inputUpdate(value, min, max, id, 'brightnessS')">
	
	<label for="colourS" >Colour</label>
	<input type="range" id="colourS" min = "0" max = "300" step = "0.1" value="1" onInput="inputUpdate(value, min,max, id, 'colourT')">
	<input type="text" id="colourT" value = "1" onInput="inputUpdate(value, min,max, id, 'colourS')">
		
	<label for="fadeS" >Fade rate</label>
	<input type="range" id="fadeS"  min = "0" max = "100" step = "0.1" value="25" onInput="inputUpdate(value, min, max,id, 'fadeT')">
		<input type="text" id="fadeT" value = "25" onInput="inputUpdate(value, min, max, id, 'fadeT')">
	
</div>


<script>
	
	var mouseX = 0;
	var mouseY = 0;
	
	var title = document.querySelector("#theTitle");
	var mainCanvas = document.querySelector("#screen");
	var mainContext = mainCanvas.getContext("2d");
	mainCanvas.addEventListener('mousemove', function(event){
			mouseX = event.pageX - mainCanvas.offsetLeft;
			mouseY = event.pageY - mainCanvas.offsetTop;
	});
	
	var canvasWidth = mainCanvas.width;
	var canvasHeight = mainCanvas.height;
	


	var requestAnimationFrame = window.requestAnimationFrame || 
                            window.mozRequestAnimationFrame || 
                            window.webkitRequestAnimationFrame || 
                            window.msRequestAnimationFrame;
							
							



var fadeRate = 5; //0 to 100
var brightness = 50;
var lamp = "rgba(0, 255, 0, 1)";

mainContext.fillStyle = "rgba(0,0,0,1)";
mainContext.fillRect(0, 0, canvasWidth, canvasHeight);
drawPhotons();

function drawPhotons() {
	
	mainContext.fillStyle = "rgba(0,0,0," + fadeRate/100 + ")";
	mainContext.fillRect(0, 0, canvasWidth, canvasHeight);	

	var randBright = Math.round(brightness + 0.1*brightness*(Math.random() - 0.5));

  for (var i = 0; i < randBright; i++) {
	  mainContext.fillStyle = lamp;
	  mainContext.fillRect(canvasWidth*Math.random(), canvasHeight*Math.random(),1,1);
  }
  
mainContext.beginPath();
mainContext.arc(canvasWidth/2, canvasHeight/2, Math.round(canvasHeight/3), 0, 2*Math.PI, false);
mainContext.closePath();
mainContext.strokeStyle = "rgba(0,0,0,1)"
mainContext.lineWidth = 10;
mainContext.stroke();

mainContext.fillStyle = "rgba(0,0,0,1)";
mainContext.font="80px Helvetica";
mainContext.textAlign = "center";
mainContext.fillText("photons",canvasWidth/2 ,canvasHeight/2 - 45);
mainContext.fillText("are",canvasWidth/2 ,canvasHeight/2 + 40);
mainContext.fillText("phun",canvasWidth/2 ,canvasHeight/2 + 125);

mainContext.font = "30px Helvetica";
mainContext.fillText("Finer details", canvasWidth/2, canvasHeight - 60);
mainContext.font = "20px Helvetica";
  mainContext.fillText("become visible when", canvasWidth/2, canvasHeight - 40);
  mainContext.font = "15px Helvetica";
  mainContext.fillText("more photons are around", canvasWidth/2, canvasHeight - 26);
  
  requestAnimationFrame(drawPhotons);
}

function constrain (val, min, max) {
	return(Math.min(Math.max(val, min), max));
}

function inputUpdate(val, min, max, idThis, idThat) {
	val = constrain(val,min,max);
	document.querySelector("#"+idThis).value = val;
	document.querySelector("#"+idThat).value = val;
}
	
	function inputUpdateColour(val, min, max) {
		val = constrain(val,min,max);
		document.querySelector('#colourS').value = val;
		document.querySelector('#colourT').value = val;
	
}

	function inputUpdateFade(val, min, max) {
		val = constrain(val,min,max);
		document.querySelector('#fadeS').value = val;
		document.querySelector('#fadeT').value = val;
	
}


</script>
</body>
</html>
